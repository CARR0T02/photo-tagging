"use strict";(self.webpackChunkphoto_tagging=self.webpackChunkphoto_tagging||[]).push([[87],{771:function(e,t,n){n.r(t),n.d(t,{Component:function(){return w},ErrorBoundary:function(){return E}});var a=n(433),r=n(762),s=n(439),c=n(791),i=n(430),o=n(689),l=n(652),u=n(321),d=n(146),f=n(165),m=n(413),x=n(861),g=n(264),h=n(276),v=n(184);function p(e){var t=e.loading,n=e.charactersData,a=(0,c.useState)(!1),i=(0,s.Z)(a,2),o=i[0],u=i[1],d=(0,c.useState)([]),p=(0,s.Z)(d,2),j=p[0],Z=p[1];(0,c.useEffect)((function(){b(n)}),[n]);var b=function(){var e=(0,x.Z)((0,f.Z)().mark((function e(t){var n,a,s,c,i;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=(0,r.Z)(t),e.prev=2,a.s();case 4:if((s=a.n()).done){e.next=18;break}return c=s.value,e.prev=6,e.next=9,(0,h.Jt)((0,h.iH)(l.t,c.imageURL));case 9:i=e.sent,n.push((0,m.Z)((0,m.Z)({},c),{},{imageURL:i})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.log("Error in fetching download URL:"+e.t0);case 16:e.next=4;break;case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(2),a.e(e.t1);case 23:return e.prev=23,a.f(),e.finish(23);case 26:Z(n);case 27:case"end":return e.stop()}}),e,null,[[2,20,23,26],[6,13]])})));return function(t){return e.apply(this,arguments)}}();return(0,v.jsxs)("div",{id:"sidebar-container",className:"fixed flex h-full",children:[(0,v.jsxs)(g.YE,{className:"sidebar\n        ".concat(o?"":"none"," "),children:[(0,v.jsx)("h2",{className:"font-medium text-xl",children:"To Find:"}),t&&(0,v.jsx)(g.$j,{"aria-label":"Loading character data",size:"xl"}),(0,v.jsx)(g.YE.Items,{children:(0,v.jsx)(g.YE.ItemGroup,{children:!t&&j.map((function(e){return(0,v.jsxs)(g.YE.Item,{className:"flex",children:[n.length!==j.length?(0,v.jsx)(g.$j,{"aria-label":"Loading character image",size:"xl"}):(0,v.jsx)("img",{src:e.imageURL,alt:""}),(0,v.jsx)("span",{children:e.name})]},e.name)}))})})]}),(0,v.jsx)("button",{onClick:function(e){e.preventDefault(),u(!o)},className:"sticky top-1/2 text-3xl sm:text-5xl text-primary hover:text-orange-500",children:o?"<":">"})]})}function j(e){var t=e.characters,n=e.handleClick,a=e.position,r=e.visible,c=(0,s.Z)(a,2),i=c[0],o=c[1];return r?(0,v.jsx)("div",{id:"select-container",style:{left:"".concat(i,"px"),top:"".concat(o,"px")},className:"sm:text-base text-xs",children:t.map((function(e){return(0,v.jsx)("button",{onClick:function(){n(e.name)},children:e.name},e.name)}))}):void 0}function Z(e){var t=e.message,n=void 0===t?"You found one!":t;return(0,v.jsxs)(g.FN,{className:"!bg-green-200",children:[(0,v.jsx)("div",{className:"text-sm sm:text-base font-normal text-gray-600",children:n}),(0,v.jsx)(g.FN.Toggle,{className:"!bg-green-200 text-gray-600"})]})}function b(e){var t=e.message,n=void 0===t?"That's incorrect!":t;return(0,v.jsxs)(g.FN,{className:"!bg-red-200",children:[(0,v.jsx)("div",{className:"text-sm sm:text-base font-normal text-gray-600",children:n}),(0,v.jsx)(g.FN.Toggle,{className:"!bg-red-200 text-gray-600"})]})}function N(e){var t=e.toastList,n=e.setToastList;(0,c.useEffect)((function(){var e=setInterval((function(){t.length&&r(1)}),2e3);return function(){clearInterval(e)}}),[t]);var r=function(e){var r=t.slice(e);n((0,a.Z)(r))};return(0,v.jsx)("div",{id:"toast-container",className:"fixed top-16 right-3 w-40 sm:w-56 grid gap-2",children:t.map((function(e,t){return e.isCorrect?(0,v.jsx)(Z,{message:"You found ".concat(e.name)},t):(0,v.jsx)(b,{},t)}))})}var y=n(87);function k(e){var t=e.hasWon;return(0,c.useEffect)((function(){var e=document.querySelector("#win-modal");return t&&e.showModal(),function(){e.close()}}),[t]),(0,v.jsx)("dialog",{id:"win-modal",onKeyDown:function(e){"Escape"===e.key&&e.preventDefault()},className:"rounded-md",children:(0,v.jsxs)("div",{className:"grid justify-items-center gap-2",children:[(0,v.jsx)("p",{children:"Congratulations on completing the level!"}),(0,v.jsx)("p",{className:"bg-primary max-w-fit p-2 rounded-lg ",children:(0,v.jsx)(y.rU,{to:"/",children:"Back to Home"})})]})})}function w(){var e=(0,o.TH)().state,t=e.docData,n=e.imageURL,i=e.docID,f=(0,d.fM)((0,u.hJ)(l.db,"levels",i,"characters")),m=(0,s.Z)(f,2),x=m[0],g=m[1],h=(0,c.useState)([]),Z=(0,s.Z)(h,2),b=Z[0],y=Z[1],w=(0,c.useState)([]),E=(0,s.Z)(w,2),L=E[0],S=E[1],Y=(0,c.useState)(!1),D=(0,s.Z)(Y,2),T=D[0],I=D[1],R=(0,c.useState)([0,0]),U=(0,s.Z)(R,2),F=U[0],B=U[1],H=(0,c.useState)([]),q=(0,s.Z)(H,2),z=q[0],J=q[1],M=(0,c.useState)(!1),W=(0,s.Z)(M,2),X=W[0],$=W[1];return(0,c.useEffect)((function(){return g||(y(function(e){var t=e.docs.map((function(e){return e.data()}));return t}(x)),document.addEventListener("keydown",(function(e){"Escape"===e.key&&T&&I(!1)}))),function(){J([]),$(!1)}}),[g]),(0,c.useEffect)((function(){g||0!==b.length||$(!0)}),[b]),(0,v.jsxs)("div",{id:"game-page",children:[(0,v.jsx)(j,{characters:b,handleClick:function(e){I(!1);var t,n,c=(0,s.Z)(L,2),i=c[0],o=c[1],l=(0,r.Z)(b);try{for(l.s();!(n=l.n()).done;){var u=n.value;u.name===e&&(t=u)}}catch(d){l.e(d)}finally{l.f()}!function(e,t,n){var a=.05,r=(0,s.Z)(n.coords,2),c=r[0],i=r[1];if(c+a>e&&c-a<e&&i+a>t&&i-a<t)return!0;return!1}(i,o,t)?J([].concat((0,a.Z)(z),[C(!1)])):(!function(e){y(b.filter((function(t){return t!==e})))}(t),J([].concat((0,a.Z)(z),[C(!0,t.name)])))},position:F,visible:T}),(0,v.jsx)(p,{charactersData:b,loading:g}),(0,v.jsx)("div",{id:"image-container",className:" flex justify-center",onClick:function(e){if(T)I(!1);else{I(!0);var t=function(e,t){var n=document.querySelector("#game-image").getBoundingClientRect(),a=(e-n.left)/n.width,r=(t-n.top)/n.height;return[a,r]}(e.clientX,e.clientY),n=(0,s.Z)(t,2),a=n[0],r=n[1];S([a,r]),B([e.pageX,e.pageY])}},children:(0,v.jsx)("img",{id:"game-image",src:n,alt:null===t||void 0===t?void 0:t.levelName,className:"w-full max-w-screen-xl"})}),(0,v.jsx)(N,{toastList:z,setToastList:J}),X&&(0,v.jsx)(k,{hasWon:X})]})}function E(){return(0,v.jsx)(i.Z,{})}function C(e){return{isCorrect:e,name:arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0}}}}]);
//# sourceMappingURL=87.461bd9c6.chunk.js.map